<html>

<body>
	<pre>Simple spreadsheet</pre>
	<div><input id="editor" /></div>
	<div id="spread" style="position:relative; display:block;"></div>
	<div style="position:absolute; bottom:0px;"><pre id="status_bar"></pre></div>

	<script>
		var rows = 20;
		var cols = 20;

		var cell_width = 50;
		var cell_height = 20;

		var cells = new Map();

		var last_focus;
		var editing = null;

		class Cell {
			constructor(x, y) {
				this.x = x;
				this.row = String.fromCharCode('A'.charCodeAt(0) + x);
				this.col = y;
				this.name = this.row + this.col;

				let dom = document.createElement('input');
				dom.type = 'text';
				dom.style.position = "absolute";
				dom.style.width = `${cell_width}px`;
				dom.style.height = `${cell_height}px`;
				dom.style.left = `${x * cell_width}px`;
				dom.style.top = `${y * cell_height}px`;
				dom.id = this.name;
				dom.onclick = (e) => {
					document.getElementById('status_bar').innerHTML = dom.id;
					console.log(editing);

					if (editing) {
						e.preventDefault();
						editing.dom.focus();
						editing.dom.value += ' ' + this.name;
						return false;
					}
				}
				dom.onkeydown = (e) => {
					editing = this;

					console.log(e.code);
					if (e.code == 'Enter' || e.code == 'Escape') {
						console.log('enter')
						editing = null;
					}
				}

				this.dom = dom;

				spread.appendChild(dom);
			}

		}

		for (let y = 0; y < rows; y++) {
			for (let x = 0; x < cols; x++) {
				let cell = new Cell(x, y);
				cells.set(cell.name, cell);
			}
		}
	</script>
</body>

</html>